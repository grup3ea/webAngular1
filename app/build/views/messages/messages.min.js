/*! fooddportsweb - v0.0.0 - 2017-01-21 */"use strict";angular.module("myApp.messages",["ngRoute","chart.js","ngAnimate","toastr","luegg.directives"]).config(["$routeProvider",function(a){a.when("/messages",{templateUrl:"views/messages/messages.html",controller:"MessagesCtrl"})}]).controller("MessagesCtrl",function(a,b,c,d,e,f){a.storageuser=JSON.parse(localStorage.getItem("fs_web_userdata")),a.selectedConversation={},a.indexSelectedConversation,a.selectConversation=function(b,c){console.log(b),a.selectedConversation=b,a.indexSelectedConversation=c},a.sendMessage=function(){""!=a.newMessage.message&&a.newMessage.message&&b({url:urlapi+"conversations/"+a.selectedConversation._id,method:"POST",data:a.newMessage}).then(function(b){console.log(b),a.conversations=b.data,a.selectedConversation=a.conversations[a.indexSelectedConversation],a.newMessage={}},function(){e.error("Failed on sending message")})},a.conversations=[],a.getConversations=function(){b.get(urlapi+"conversations").then(function(b){console.log(Date()),console.log("data success"),console.log(b),a.conversations=b.data,a.selectedConversation=a.conversations[a.indexSelectedConversation]},function(a,b){console.log("data error"),console.log(b),console.log(a)}).then(function(a){})},"#!/messages"==window.location.hash?(console.log("messages page"),a.timer=setInterval(function(){"#!/messages"==window.location.hash&&a.getConversations()},3e3)):console.log("not messages page"),a.getConversations()});