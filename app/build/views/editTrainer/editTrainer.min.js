/*! fooddportsweb - v0.0.0 - 2017-01-21 */"use strict";angular.module("myApp.editTrainer",["ngRoute"]).config(["$routeProvider",function(a){a.when("/editTrainer/:trainerid",{templateUrl:"views/editTrainer/editTrainer.html",controller:"EditTrainerCtrl"})}]).controller("EditTrainerCtrl",function(a,b,c,d,e,f,g,h){a.storageuser=JSON.parse(localStorage.getItem("fs_web_userdata")),"trainer"!=a.storageuser.role&&(window.location="#!/dashboard"),a.trainer={},b.get(urlapi+"trainers/"+c.trainerid).then(function(b){a.trainer=b.data},function(a,b){}).then(function(a){}),a.updateTrainer=function(){b({url:urlapi+"trainers/"+c.trainerid,method:"PUT",data:a.trainer}).then(function(b){a.trainer=b.data,localStorage.setItem("fs_web_userdata",JSON.stringify(b.data)),a.storageuser=JSON.parse(localStorage.getItem("fs_web_userdata")),d.show(d.simple().textContent("Trainer updated").position("bottom right").hideDelay(3e3)),window.location="#!/user/"+a.storageuser._id},function(){d.show(d.simple().textContent("Failed on updating trainer").position("bottom right").hideDelay(3e3))})},a.uploadFileAvatar=function(b,c){console.log(c);var d=new Date;a.title="Image ("+d.getDate()+" - "+d.getHours()+":"+d.getMinutes()+":"+d.getSeconds()+")",a.trainer.imgfileAvatar=b,a.trainer.imgfileAvatar&&b&&!b.$error&&(console.log(b),b.upload=g.upload({url:"https://api.cloudinary.com/v1_1/"+h.config().cloud_name+"/upload",data:{upload_preset:h.config().upload_preset,tags:"myphotoalbum",context:"photo="+a.title,file:b},headers:{"X-Access-Token":void 0}}).progress(function(a){b.progress=Math.round(100*a.loaded/a.total),b.status="Uploading... "+b.progress+"%"}).success(function(c,d,f,g){console.log(c.url),a.trainer.avatar=c.url,e.photos=e.photos||[],c.context={custom:{photo:a.title}},b.result=c,e.photos.push(c)}).error(function(a,c,d,e){b.result=a}))},a.uploadFileBackground=function(b,c){console.log(c);var d=new Date;a.title="Image ("+d.getDate()+" - "+d.getHours()+":"+d.getMinutes()+":"+d.getSeconds()+")",a.trainer.imgfileBackground=b,a.trainer.imgfileBackground&&b&&!b.$error&&(console.log(b),b.upload=g.upload({url:"https://api.cloudinary.com/v1_1/"+h.config().cloud_name+"/upload",data:{upload_preset:h.config().upload_preset,tags:"myphotoalbum",context:"photo="+a.title,file:b},headers:{"X-Access-Token":void 0}}).progress(function(a){b.progress=Math.round(100*a.loaded/a.total),b.status="Uploading... "+b.progress+"%"}).success(function(c,d,f,g){console.log(c.url),a.trainer.background=c.url,e.photos=e.photos||[],c.context={custom:{photo:a.title}},b.result=c,e.photos.push(c)}).error(function(a,c,d,e){b.result=a}))}});