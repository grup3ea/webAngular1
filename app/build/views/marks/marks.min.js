/*! fooddportsweb - v0.0.0 - 2017-01-22 */"use strict";angular.module("myApp.marks",["ngRoute","chart.js","ngAnimate","toastr"]).config(["$routeProvider",function(a){a.when("/marks/:userid",{templateUrl:"views/marks/marks.html",controller:"MarksCtrl"})}]).controller("MarksCtrl",function(a,b,c,d,e,f,g){function h(a,c,d,e,f,h,i){a.storageuser=JSON.parse(localStorage.getItem("fs_web_userdata")),a.hide=function(){c.hide()},a.cancel=function(){c.cancel()},a.markSended=function(a){c.hide(a)},a.sendNewMark=function(){b({url:urlapi+"users/newMark",method:"POST",data:a.newMark}).then(function(b){console.log(b),i.success("New mark added to your marks"),a.markSended(b.data),g.reload()},function(){i.error("Failed on adding mark to your marks")})}}function i(a,c,d,e,f,h,i){a.storageuser=JSON.parse(localStorage.getItem("fs_web_userdata")),a.hide=function(){c.hide()},a.cancel=function(){c.cancel()},a.markSended=function(a){c.hide(a)},a.sendAddDayToMark=function(){b({url:urlapi+"users/marks/"+j._id+"/addDayToMark",method:"POST",data:a.newDay}).then(function(b){console.log(b),i.success("New mark added to your marks"),a.markSended(b.data),g.reload()},function(){i.error("Failed on adding mark to your marks")})}}a.storageuser=JSON.parse(localStorage.getItem("fs_web_userdata")),a.user={},b.get(urlapi+"users/"+c.userid+"/network").then(function(b){console.log("data success"),console.log(b),a.user=b.data},function(a,b){console.log("data error"),console.log(b),console.log(a)}).then(function(a){}),a.orderByMe=function(b){a.orderBy=b},a.data=[],a.labels=[],a.generateGraph=function(b){a.markSelected=b.title,console.log("generant data de gràfic"),a.data=[],a.labels=[];for(var c=0;c<b.days.length;c++)a.data.push(b.days[c].value),a.labels.push(d("date")(b.days[c].date,"dd.MM.y"));console.log("algoritme de generació de la data del gràfic completat"),console.log(a.data),console.log(a.labels)},a.showNewMarkDialog=function(b){e.show({controller:h,templateUrl:"views/marks/newmark.tmpl.html",parent:angular.element(document.body),targetEvent:b,clickOutsideToClose:!0,fullscreen:a.customFullscreen}).then(function(a){},function(){})};var j;a.showAddDayToMarkDialog=function(b,c){j=c,e.show({controller:i,templateUrl:"views/marks/adddaytomark.tmpl.html",parent:angular.element(document.body),targetEvent:b,clickOutsideToClose:!0,fullscreen:a.customFullscreen}).then(function(a){},function(){})},a.deleteMark=function(a,c){var d=e.confirm().title("Delete this mark?").textContent("Are you sure?").ariaLabel("Lucky day").targetEvent(a).ok("Yes, delete").cancel("Cancel");e.show(d).then(function(){b({url:urlapi+"users/marks/"+c._id,method:"Delete"}).then(function(a){console.log("response: "),console.log(a.data),f.success("Mark deleted!"),g.reload()},function(a){f.error("Failed on deleting mark")})},function(){f.info("Operation canceled")})}});