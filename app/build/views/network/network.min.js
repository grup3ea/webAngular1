/*! fooddportsweb - v0.0.0 - 2017-01-22 */"use strict";angular.module("myApp.network",["ngRoute","ngAnimate","toastr"]).config(["$routeProvider",function(a){a.when("/network",{templateUrl:"views/network/network.html",controller:"NetworkCtrl"})}]).controller("NetworkCtrl",function(a,b,c,d,e){function f(a,b,c){console.log(c),a.urlImg=c.urlImg,a.storageuser=JSON.parse(localStorage.getItem("fs_web_userdata")),a.hide=function(){b.hide()},a.cancel=function(){b.cancel()},a.answer=function(a){b.hide(a)}}a.storageuser=JSON.parse(localStorage.getItem("fs_web_userdata")),b.get(urlapi+"users/"+a.storageuser._id+"/network").then(function(b){console.log("data success"),console.log(b),localStorage.setItem("fs_web_userdata",JSON.stringify(b.data)),a.storageuser=b.data},function(a,b){console.log("data error"),console.log(b),console.log(a)}).then(function(a){}),a.newsfeed=[],b.get(urlapi+"publications/newsfeed").then(function(b){console.log("data success"),console.log(b),a.newsfeed=b.data},function(a,b){console.log("data error"),console.log(b),console.log(a)}).then(function(a){}),a.showImgComplete=function(b,d){console.log(d),c.show({controller:f,templateUrl:"views/imgComplete.tmpl.html",locals:{urlImg:d},parent:angular.element(document.body),targetEvent:b,clickOutsideToClose:!0,fullscreen:a.customFullscreen})},a.arrayObjectIndexOf=function(a,b){if(a)for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},a.sendLikeToPublication=function(c,e){console.log(e),console.log("like - "+c.title),b({url:urlapi+"publications/"+c._id+"/like",method:"POST"}).then(function(b){console.log(b.data),d.success("liked publication");for(var c=0;c<a.newsfeed.length;c++)a.newsfeed[c]._id==b.data._id&&(a.newsfeed[c]=b.data)},function(){d.error("Failed on posting like publication")})},a.sendDislikeToPublication=function(c,e){console.log(e),console.log("dislike - "+c.title),b({url:urlapi+"publications/"+c._id+"/dislike",method:"POST"}).then(function(b){console.log(b.data),d.success("disliked publication");for(var c=0;c<a.newsfeed.length;c++)a.newsfeed[c]._id==b.data._id&&(a.newsfeed[c]=b.data)},function(){d.error("Failed on posting dislike publication")})},a.deletePublication=function(a,f){var g=c.confirm().title("Delete this publication?").textContent("Are you sure?").ariaLabel("Lucky day").targetEvent(a).ok("Yes, delete").cancel("Cancel");c.show(g).then(function(){b({url:urlapi+"publications/"+f,method:"Delete"}).then(function(a){console.log("response: "),console.log(a.data),d.success("Publication deleted!"),e.reload()},function(a){d.error("Failed on deleting publication")})},function(){d.info("Operation canceled")})},a.orderByMe=function(b){a.orderBy=b},a.suggestions=[],b.get(urlapi+"users/"+a.storageuser._id+"/suggestions").then(function(b){console.log("data success"),console.log(b),a.suggestions=b.data},function(a,b){console.log("data error"),console.log(b),console.log(a)}),a.doFollow=function(a){b({url:urlapi+"users/follow",method:"POST",data:{userid:a._id}}).then(function(b){console.log(b.data),d.info("User: "+a.name+" followed"),e.reload()},function(){d.error("Failed on following user")})}});