/*! fooddportsweb - v0.0.0 - 2017-01-22 */"use strict";angular.module("myApp.login",["ngRoute","ng.deviceDetector"]).config(["$routeProvider",function(a){a.when("/login",{templateUrl:"views/login/login.html",controller:"LoginCtrl"})}]).controller("LoginCtrl",function(a,b,c,d,e,f){var g=this;g.data=f;var h=$.getJSON("//freegeoip.net/json/?callback=?",function(a){h=JSON.stringify(a),console.log(h)});console.log("userAgent: "+g.data.raw.userAgent),a.loginData={},a.doLogin=function(){console.log("Doing login",a.loginData),a.loginData.userAgent=g.data.raw.userAgent,a.loginData.os=g.data.os,a.loginData.browser=g.data.browser,a.loginData.device=g.data.device,a.loginData.os_version=g.data.os_version,a.loginData.ip=h,a.loginData.browser_version=g.data.browser_version,b({url:urlapi+"users/login",method:"POST",data:a.loginData}).then(function(a){console.log("response: "),console.log(a.data),1==a.data.success?(localStorage.setItem("fs_web_token",a.data.token),localStorage.setItem("fs_web_userdata",JSON.stringify(a.data.user)),window.location.reload()):(console.log("login failed"),e.show(e.simple().textContent("Account not found").position("bottom right").hideDelay(3e3)))},function(a){console.log(a)})},a.doSignup=function(){console.log("Doing signup",a.signupData),a.emptyParams(a.signupData)?b({url:urlapi+"users/register",method:"POST",data:a.signupData}).then(function(a){console.log("response: "),console.log(a.data),1==a.data.success?(localStorage.setItem("fs_web_token",a.data.token),localStorage.setItem("fs_web_userdata",JSON.stringify(a.data.user)),window.location.reload()):(console.log("login failed"),e.show(e.simple().textContent("Account not found").position("bottom right").hideDelay(3e3)))},function(a){console.log("Email already in use")}):console.log("First complete all parameters")},a.emptyParams=function(a){return void 0!=a.name&&(void 0!=a.password&&void 0!=a.email)}});